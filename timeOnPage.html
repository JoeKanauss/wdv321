<html>
<head>
<script src="js/jquery-3.2.1.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<script src="js/cookieFunctions.js"></script>

<script>
$(document).ready(function(){
	var chiliStart = "";
	var r2Start = "";
	var r3Start = "";
	var chiliStartInMilli = "";
	var r2StartInMilli = "";
	var r3StartInMilli = "";

	var chiliEnd = "";
	var r2End = "";
	var r3End = "";
	var chiliEndInMilli = "";
	var r2EndInMilli = "";
	var r3EndInMilli = "";



	$("#tabs").tabs({
		activate: function(){
		
		var lastSectionArray = [];
		var lastSection = lastSectionArray[lastSectionArray.length-2];
		var activeTab = $("#tabs").tabs("option","active");
		
		if(activeTab == 1)
		{
			if(lastSection == "zucchini")
			{
				r2End = new Date();
				r2EndInMilli = Date.parse(r2End);
				setCookie("r2End", r2EndInMilli, 3);
			}
			else
			{
				if(lastSection == "guacamole");
				{
				r3End = new Date();
				r3EndInMilli = Date.parse(r3End);
				setCookie("r3End", r3EndInMilli, 3);
				}
			}

			lastSectionArray.push("chili");
			chiliStart = new Date();
			chiliStartInMilli = Date.parse(chiliStart);
			setCookie("chiliStart", chiliStartInMilli, 3);
			return(chiliStartInMilli);
			
		}
		else
		{
			if(activeTab == 2)
			{
				if(lastSection =="chili")
				{
					chiliEnd = new Date();
					chiliEndInMilli = Date.parse(chiliEnd);
					setCookie("chiliEnd", chiliEndInMilli, 3);
				}
				else
				{
					if(lastSection == "guacamole");
					{
					r3End = new Date();
					r3EndInMilli = Date.parse(r3End);
					setCookie("r3End", r3EndInMilli, 3);
					}
				}
			
				lastSectionArray.push("zucchini");
				r2Start = new Date();
				r2StartInMilli = Date.parse(r2Start);
				setCookie("r2Start", r2StartInMilli, 3);
				return(r2StartInMilli);
			}
			else
			{
				if(activeTab == 3)
				{
					if(lastSection == "chili")
					{
						chiliEnd = new Date();
						chiliEndInMilli = Date.parse(chiliEnd);
						setCookie("chiliEnd", chiliEndInMilli, 3);
					}
					else
					{
						if(lastSection == "zucchini")
						{
						r2End = new Date();
						r2EndInMilli = Date.parse(r2End);
						setCookie("r2End", r2EndInMilli, 3);
						}	
					}
				
					lastSectionArray.push("guacamole");
					r3Start = new Date();
					r3StartInMilli = Date.parse(r3Start);
					setCookie("r3Start", r3StartInMilli, 3);
					return(r3StartInMilli);
				}
			}
		}
		}
	});

	
	$("#getTimes").click(function(){
	
		//When the button is clicked, make sure that whatever tab is opened has an end time that is after their start time
		var activeTab = $("#tabs").tabs("option","active");
		
		if(activeTab == 1)
		{
			var chiliEnd = new Date();
			var chiliEndInMilli = Date.parse(chiliEnd);
			setCookie("chiliEnd", chiliEndInMilli, 3);
		}
		else
		{
			if(activeTab == 2)
			{
				var r2End = new Date();
				var r2EndInMilli = Date.parse(r2End);
				setCookie("r2End", r2EndInMilli, 3);
			}
			else
			{
				if(activeTab == 3)
				{
					var r3End = new Date();
					var r3EndInMilli = Date.parse(r3End);
					setCookie("r3End", r3EndInMilli, 3);
				}
			}
		}
		
		
		var chiliStartTime = getCookie("chiliStart");
		var chiliEndTime = getCookie("chiliEnd");
		var chiliTime = chiliEndTime - chiliStartTime;
		
		
			var chiliTimeInSeconds = chiliTime/1000;
			var chiliTimeMinutes = Math.floor(chiliTimeInSeconds/60);
			var chiliTimeSeconds = chiliTimeInSeconds - chiliTimeMinutes*60;
			var totalChiliTime = "Minutes: "+chiliTimeMinutes + " Seconds: "+chiliTimeSeconds;
		if(chiliStartTime = "")
		{
			totalChiliTime = 0;
		}
		else
		{
			$("#chiliTime").html("Chili Time: "+totalChiliTime);
		}
		
			
	
	
		var r2StartTime = getCookie("r2Start");
		var r2EndTime = getCookie("r2End");
		var r2Time = r2EndTime - r2StartTime;
		
			var r2TimeInSeconds = r2Time/1000;
			var r2TimeMinutes = Math.floor(r2TimeInSeconds/60);
			var r2TimeSeconds = r2TimeInSeconds - r2TimeMinutes*60;
			var totalR2Time = "Minutes: "+r2TimeMinutes + " Seconds: "+r2TimeSeconds;
		
		if(r2StartTime == "")
		{
			totalR2Time = 0;
		}
		else
		{
			$("#r2Time").html("r2 Time: "+totalR2Time);
		}
		
		
		
		var r3StartTime = getCookie("r3Start");
		var r3EndTime = getCookie("r3End");
		var r3Time = r3EndTime - r3StartTime;
		
			var r3TimeInSeconds = r3Time/1000;
			var r3TimeMinutes = Math.floor(r3TimeInSeconds/60);
			var r3TimeSeconds = r3TimeInSeconds - r3TimeMinutes*60;
			var totalR3Time = "Minutes: "+r3TimeMinutes + " Seconds: "+r3TimeSeconds;
			
		if(r3StartTime == "")
		{
			totalR3Time = 0;
		}
		else
		{
			$("#r3Time").html("r3 Time: "+totalR3Time);
		}
		
	});

	$("#clear").click(function(){
		setCookie("chiliStart", chiliStartInMilli, -3);
		setCookie("chiliEnd", chiliEndInMilli, -3);
		setCookie("r2Start", r2StartInMilli, -3);
		setCookie("r2End", r2EndInMilli, -3);
		setCookie("r3Start", r3StartInMilli, -3);
		setCookie("r3End", r3EndInMilli, -3);
	});
	
});

</script>
</head>
<body>
<div id="tabs">
<ul>
<li><a href="#front">Dynamic Recipes</a></li>
<li id="chiliTab"><a href="#chili">Crockpot Chili</a></li>
<li id="r2Tab"><a href="#recipe2">Zucchini Bread</a></li>
<li id="r3Tab"><a href="#recipe3">Guacamole</a></li>
</ul>

<div id="front">
<h1>Dynamic Recipes</h1>
</div>

<div id="chili">
<h1>Chili</h1>
</div>

<div id="recipe2">
<h1>Recipe 2</h1>
</div>

<div id="recipe3">
<h1>Recipe 3</h1>
</div>
<input type="button" id="getTimes" value="get all times">
<input type="button" id="clear" value="clear cookies">
<p id="chiliTime"></p>
<p id="r2Time"></p>
<p id="r3Time"></p>


</body>